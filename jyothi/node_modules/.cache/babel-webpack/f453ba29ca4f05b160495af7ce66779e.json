{"ast":null,"code":"import { bookingUrls } from 'src/api-urls';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"./shared/loader.component\";\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(router, http) {\n      this.router = router;\n      this.http = http;\n      this.title = 'EzyContracts';\n      this.CHECK_INTERVAL = 5; // in ms\n\n      this.STORE_KEY = 'lastAction';\n    }\n\n    getLastAction() {\n      return parseInt(localStorage.getItem(this.STORE_KEY));\n    }\n\n    setLastAction(lastAction) {\n      localStorage.setItem(this.STORE_KEY, lastAction.toString());\n    }\n\n    ngOnInit() {\n      this.check();\n      this.initListener();\n      this.initInterval();\n      localStorage.setItem(this.STORE_KEY, Date.now().toString());\n      setTimeout(() => {\n        this.company = JSON.parse(localStorage.getItem('companyData'));\n\n        if (this.company) {\n          this.getCompany(this.company.company_code);\n        }\n      }, 3000);\n    }\n\n    initListener() {\n      document.body.addEventListener('click', () => this.reset());\n      document.body.addEventListener('mouseover', () => this.reset());\n      document.body.addEventListener('mouseout', () => this.reset());\n      document.body.addEventListener('keydown', () => this.reset());\n      document.body.addEventListener('keyup', () => this.reset());\n      document.body.addEventListener('keypress', () => this.reset());\n    }\n\n    reset() {\n      this.setLastAction(Date.now());\n    }\n\n    initInterval() {\n      setInterval(() => {\n        this.check();\n      }, this.CHECK_INTERVAL);\n    }\n\n    check() {\n      const now = Date.now();\n      const timeleft = this.getLastAction() + this.MINUTES_UNITL_AUTO_LOGOUT * 60 * 1000;\n      const diff = timeleft - now;\n      const isTimeout = diff < 0;\n\n      if (isTimeout) {\n        localStorage.clear();\n        this.router.navigate(['/login']);\n      }\n    }\n\n    getCompany(val) {\n      this.http.get(bookingUrls.company + `/${val}`).subscribe(res => {\n        var _a;\n\n        if (res.data) {\n          this.MINUTES_UNITL_AUTO_LOGOUT = ((_a = res.data) === null || _a === void 0 ? void 0 : _a.logout) || 15;\n        }\n      });\n    }\n\n  }\n\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.HttpClient));\n  };\n\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    decls: 2,\n    vars: 0,\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"app-loader\");\n        i0.ɵɵelement(1, \"router-outlet\");\n      }\n    },\n    directives: [i3.LoaderComponent, i1.RouterOutlet],\n    styles: [\"\"]\n  });\n  return AppComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}